<!DOCTYPE html>
<html>
<head>

	<header>
		<em>Back to <a href="index.html">Index</a>.</em>
	</header>

	<title>Using variables</title>

	<style type="text/css">
		body {
    margin: 1em auto;
    max-width: 60em;
    padding-bottom: 95vh;
    width: 88%;
    font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji";
    font-size: 14px;
    line-height: 1.5;
    color: var(--color-fg-default);
    background-color: var(--color-canvas-default);
}

h3 {
    text-decoration: underline;
}

#myBtn {
    display: none; /* Hidden by default */
    position: fixed; /* Fixed/sticky position */
    bottom: 20px; /* Place the button at the bottom of the page */
    right: 30px; /* Place the button 30px from the right */
    z-index: 99; /* Make sure it does not overlap */
    border: none; /* Remove borders */
    outline: none; /* Remove outline */
    background-color: grey; /* Set a background color */
    color: white; /* Text color */
    cursor: pointer; /* Add a mouse pointer on hover */
    padding: 15px; /* Some padding */
    border-radius: 10px; /* Rounded corners */
    font-size: 18px; /* Increase font size */
}

#myBtn:hover {
    background-color: #555; /* Add a dark-grey background on hover */
}

pre code {
    background-color: #2b2b2b;
    color: #9ba8b6;
    display: block;
    padding: 16px;
    overflow: auto;
    border-radius: 6px;
    font-family: ui-monospace,SFMono-Regular,SF Mono,Menlo,Consolas,Liberation Mono,monospace;
    font-size: 90%;
    border-style: solid;
    border-width: 1px;
    border-color: darkgray;
}

.gherkin-keyword {
    color: #c47432;
}

gherkin-tag {
    color: #aca729;
}

.highlight-wrapper {
    display: block;
}

.highlight-wrapper {
    display: block;
}

.highlight {
    position: relative;
    z-index: 0;
    padding: 0;
    margin: 0;
    border-radius: 4px;
}

.highlight > .chroma {
    color: #d0d0d0;
    background-color: #212121;
    position: static;
    z-index: 1;
    border-radius: 4px;
    padding: 10px;
}

.chroma {
    overflow: auto;
}

.chroma .lntable {
    display: table;
    width: 100%;
    padding: 0 0 5px;
    margin: 0;
    border-spacing: 0;
    border: 0;
    overflow: auto;
}

.chroma .lntd:first-child {
    padding: 7px 7px 7px 10px;
    margin: 0;
}

.chroma .lntd:last-child {
    padding: 7px 10px 7px 7px;
    margin: 0;
}

.copy-code-button {
    position: absolute;
    z-index: 2;
    right: 0;
    top: 0;
    font-size: 13px;
    font-weight: 700;
    line-height: 14px;
    width: 65px;
    color: white;
    background-color: #808080;
    border: 1.25px solid #232326;
    border-top-left-radius: 0;
    border-top-right-radius: 4px;
    border-bottom-right-radius: 0;
    border-bottom-left-radius: 4px;
    white-space: nowrap;
    padding: 4px 4px 5px 4px;
    margin: 0 0 0 1px;
    cursor: pointer;
    opacity: 0.6;
}

.copy-code-button:hover,
.copy-code-button:focus,
.copy-code-button:active,
.copy-code-button:active:hover {
    color: #222225;
    background-color: #b3b3b3;
    opacity: 0.8;
}

.copyable-text-area {
    position: absolute;
    height: 0;
    z-index: -1;
    opacity: 0.01;
}
	</style>
</head>
<body>

	<h1>Using variables</h1>

	<p>
  This feature provides an example on how to use variables in GingerSpec. The default definition of a variable
  is ${variableName}. GingerSpec will try to get the value of 'variableName' before executing the step. if GingerSpec
  is unable to find the value, the test will fail. You can use variables at any point in your feature file: feature title,
  description, scenario description steps, datatables, docstrings and even comments.

  There are many ways of creating new variables: you can pass variables via the CLI using -DvariableName=variableValue,
  or they can be defined in a previous step. You can also use variables to automatically generate fake data. Please, read
  the full documentation here: https://github.com/veepee-oss/gingerspec/wiki/Gherkin-variables

</p>

	<div data-toc></div>

	<hr>

	<div data-content>

		<button onclick="topFunction()" id="myBtn" title="Go to top">Back to top</button>

		<ol>
			<li><h2>Using variables in Scenario names, titles, log messages, datatables, docStrings</h2></li>
			<ul>
			<li><h3>Replacements scenario title and log comments. 1.0</h3></li>
			<div class="highlight">
			<pre><code class="language-gherkin">
			
    <span class="gherkin-keyword">Scenario: </span>Replacements scenario title and log comments. 1.0
      #log The value of VERSION in the title should be ${VERSION}
      <span class="gherkin-keyword">And </span>I wait '1' seconds
			</code></pre>
			</div>
			</ul>
			<ul>
			<li><h3>Simplest read {} on scenario name</h3></li>
			<div class="highlight">
			<pre><code class="language-gherkin">
			
    <span class="gherkin-keyword">Scenario: </span>Simplest read {} on scenario name
      <span class="gherkin-keyword">Given </span>I run 'ls' locally
			</code></pre>
			</div>
			</ul>
			<ul>
			<li><h3>Replacements in datatables</h3></li>
			<div class="highlight">
			<pre><code class="language-gherkin">
			
    <span class="gherkin-keyword">Scenario: </span>Replacements in datatables
      <span class="gherkin-keyword">Given </span>this is a datatable:
        <span class="gherkin-keyword">|</span> $.title  <span class="gherkin-keyword">|</span> contains  <span class="gherkin-keyword">|</span> ${faker:number.number_between '1','10'}    <span class="gherkin-keyword">|</span>
        <span class="gherkin-keyword">|</span> $.body   <span class="gherkin-keyword">|</span> contains  <span class="gherkin-keyword">|</span> This is a test: ${envProperties:wait.time} <span class="gherkin-keyword">|</span>
        <span class="gherkin-keyword">|</span> $.userId <span class="gherkin-keyword">|</span> not equal <span class="gherkin-keyword">|</span> ${VERSION}                                 <span class="gherkin-keyword">|</span>
			</code></pre>
			</div>
			</ul>
			<ul>
			<li><h3>Replacements in a DocString</h3></li>
			<div class="highlight">
			<pre><code class="language-gherkin">
			
    <span class="gherkin-keyword">Scenario: </span>Replacements in a DocString
      <span class="gherkin-keyword">Given </span>This is a DocString
        """
            {
              "userId": ${faker:number.number_between '1','10'},
              "title": "This is a test: ${envProperties:wait.time}",
              "body": "${VERSION}"
              "price": "${math:3 * sin(90) - 2 / (5 - 2)}"
            }
         """
			</code></pre>
			</div>
			</ul>

			<hr>

			<li><h2>Creating local variables</h2></li>
			<ul>
			<li><h3>Saving and replacing local variables</h3></li>
			<div class="highlight">
			<pre><code class="language-gherkin">
			
    <span class="gherkin-keyword">Scenario: </span>Saving and replacing local variables
      <span class="gherkin-keyword">Given </span>I save '2' in variable 'MY_LOCAL_VAR'
      <span class="gherkin-keyword">Then </span>'${MY_LOCAL_VAR}' is '2'
      <span class="gherkin-keyword">And </span>I wait '${MY_LOCAL_VAR}' seconds
			</code></pre>
			</div>
			</ul>
			<ul>
			<li><h3>Replacements in an scenario outline</h3></li>
			<div class="highlight">
			<pre><code class="language-gherkin">
			
    <span class="gherkin-keyword">Scenario Outline: </span>Replacements in an scenario outline
      <span class="gherkin-keyword">Given </span>I save '2' in variable 'SO_ENV_VAR'
      <span class="gherkin-keyword">And </span>I wait '${SO_ENV_VAR}' seconds
      <span class="gherkin-keyword">And </span>I wait '${SO_ENV_VAR}' seconds
      <span class="gherkin-keyword">And </span>I wait '<other>' seconds
      <span class="gherkin-keyword">And </span>I wait '${envProperties:wait.time}' seconds
      <span class="gherkin-keyword">And </span>I wait '${envProperties:wait.time}' seconds

      <span class="gherkin-keyword">Examples:</span>
        <span class="gherkin-keyword">|</span> other                      <span class="gherkin-keyword">|</span>
        <span class="gherkin-keyword">|</span> 1                          <span class="gherkin-keyword">|</span>
        <span class="gherkin-keyword">|</span> ${envProperties:wait.time} <span class="gherkin-keyword">|</span>
			</code></pre>
			</div>
			</ul>

			<hr>

			<li><h2>Injecting system variables via CLI</h2></li>
			<ul>
			<li><h3>Passing a variable via CLI using -DVERSION=1.0</h3></li>
			<div class="highlight">
			<pre><code class="language-gherkin">
			
    <span class="gherkin-keyword">Scenario: </span>Passing a variable via CLI using -DVERSION=1.0
      <span class="gherkin-keyword">Then </span>'${VERSION}' is '1.0'
			</code></pre>
			</div>
			</ul>

			<hr>

			<li><h2>Using default values</h2></li>
			<ul>
			<li><h3>Using a default value when the variable is not found</h3></li>
			<div class="highlight">
			<pre><code class="language-gherkin">
			
    <span class="gherkin-keyword">Scenario: </span>Using a default value when the variable is not found
      <span class="gherkin-keyword">Then </span>'${INVALID:-bb}' matches 'bb'
			</code></pre>
			</div>
			</ul>

			<hr>

			<li><h2>Using interpolation (StringSubstitutor library)</h2></li>
			<ul>
			<li><h3>Using default interpolators (this is just a short sample, there are many more)</h3></li>
			<div class="highlight">
			<pre><code class="language-gherkin">
			
    <span class="gherkin-keyword">Scenario: </span>Using default interpolators (this is just a short sample, there are many more)
      <span class="gherkin-keyword">Then </span>'${base64Encoder:HelloWorld!}' matches 'SGVsbG9Xb3JsZCE='
      <span class="gherkin-keyword">Then </span>'${const:java.awt.event.KeyEvent.VK_ESCAPE}' matches '27'
      <span class="gherkin-keyword">Then </span>'${date:yyyy-MM-dd}' contains '-'
      <span class="gherkin-keyword">Then </span>'${properties:src/test/resources/configuration/common.properties::wait.time}' matches '1'
			</code></pre>
			</div>
			</ul>
			<ul>
			<li><h3>Changing variables value to upper or lower case</h3></li>
			<div class="highlight">
			<pre><code class="language-gherkin">
			
    <span class="gherkin-keyword">Scenario: </span>Changing variables value to upper or lower case
      <span class="gherkin-keyword">Then </span>'${toUpperCase:${VARNAME}}' matches 'FOO'
      <span class="gherkin-keyword">Then </span>'${toLowerCase:${VARNAME}}' matches 'foo'
			</code></pre>
			</div>
			</ul>

			<hr>

			<li><h2>Recursive variable replacements</h2></li>
			<ul>
			<li><h3>use a variable inside an interpolator</h3></li>
			<div class="highlight">
			<pre><code class="language-gherkin">
			
    <span class="gherkin-keyword">Scenario: </span>use a variable inside an interpolator
      <span class="gherkin-keyword">Given </span>I save 'Foo' in variable 'VARNAME'
      <span class="gherkin-keyword">Then </span>'${toUpperCase:${VARNAME}}' matches 'FOO'
      <span class="gherkin-keyword">Then </span>'${toLowerCase:${VARNAME}}' matches 'foo'
			</code></pre>
			</div>
			</ul>

			<hr>

			<li><h2>Using environment-dependent variables</h2></li>
			<ul>
			<li><h3>Using variables from one properties file or another</h3></li>
			<div class="highlight">
			<pre><code class="language-gherkin">
			
    <span class="gherkin-keyword">Scenario: </span>Using variables from one properties file or another
      <span class="gherkin-keyword">Then </span>'${envProperties:wait.time}' matches '1'
      <span class="gherkin-keyword">Given </span>I save 'pre' in variable 'env'
      <span class="gherkin-keyword">Then </span>'${envProperties:wait.time}' matches '2'
			</code></pre>
			</div>
			</ul>

			<hr>

			<li><h2>Generating fake data</h2></li>
			<ul>
			<li><h3>Using the faker library</h3></li>
			<div class="highlight">
			<pre><code class="language-gherkin">
			
    <span class="gherkin-keyword">Scenario: </span>Using the faker library
      <span class="gherkin-keyword">Given </span>I save '${faker:number.number_between '1','10'}' in variable 'RANDOM_NUMBER'
      <span class="gherkin-keyword">Then </span>'${RANDOM_NUMBER}' is higher than '0'
      <span class="gherkin-keyword">And </span>'${RANDOM_NUMBER}' is lower than '11'
      <span class="gherkin-keyword">Given </span>I save '${faker:Internet.emailAddress}' in variable 'RANDOM_EMAIL'
      <span class="gherkin-keyword">Then </span>'${RANDOM_EMAIL}' contains '@'
      <span class="gherkin-keyword">Given </span>I save '${faker:Name.first_name}' in variable 'RANDOM_NAME'
			</code></pre>
			</div>
			</ul>

			<hr>

			<li><h2>Resolving mathematical expressions</h2></li>
			<ul>
			<li><h3>Doing a simple calculation</h3></li>
			<div class="highlight">
			<pre><code class="language-gherkin">
			
    <span class="gherkin-keyword">Scenario: </span>Doing a simple calculation
      <span class="gherkin-keyword">Given </span>I save '2' in variable 'X'
      <span class="gherkin-keyword">Given </span>I save '2' in variable 'Y'
      <span class="gherkin-keyword">Given </span>'${math:${X} + ${Y}}' is '4.0'
			</code></pre>
			</div>
			</ul>
			<ul>
			<li><h3>Doing an advanced calculation</h3></li>
			<div class="highlight">
			<pre><code class="language-gherkin">
			
    <span class="gherkin-keyword">Scenario: </span>Doing an advanced calculation
      <span class="gherkin-keyword">Given </span>'${math:3 * sin(90) - 2 / (5 - 2)}' is '2.015323324135007'
			</code></pre>
			</div>
			</ul>

			<hr>

			<li><h2>Miscellaneous and examples</h2></li>
			<ul>
			<li><h3>With scenarios outlines in examples table</h3></li>
			<div class="highlight">
			<pre><code class="language-gherkin">
			
    <span class="gherkin-keyword">Scenario Outline: </span>With scenarios outlines in examples table
      <span class="gherkin-keyword">Given </span>I save '<file>' in variable 'VAR'
      <span class="gherkin-keyword">Then </span>I run '[ "${VAR}" = "<content>" ]' locally

      <span class="gherkin-keyword">Examples:</span>
        <span class="gherkin-keyword">|</span> content     <span class="gherkin-keyword">|</span> file                                                  <span class="gherkin-keyword">|</span>
        <span class="gherkin-keyword">|</span> {}          <span class="gherkin-keyword">|</span> ${file:UTF-8:src/test/resources/schemas/simple0.json} <span class="gherkin-keyword">|</span>
        <span class="gherkin-keyword">|</span> {"a": true} <span class="gherkin-keyword">|</span> ${file:UTF-8:src/test/resources/schemas/simple1.json} <span class="gherkin-keyword">|</span>
			</code></pre>
			</div>
			</ul>
			<ul>
			<li><h3>With scenarios outlines and datatables</h3></li>
			<div class="highlight">
			<pre><code class="language-gherkin">
			
    <span class="gherkin-keyword">Scenario Outline: </span>With scenarios outlines and datatables
      <span class="gherkin-keyword">Given </span>I create file 'testSOATtag.json' based on 'schemas/simple1.json' as 'json' with:
        <span class="gherkin-keyword">|</span> $.a <span class="gherkin-keyword">|</span> REPLACE <span class="gherkin-keyword">|</span> <file> <span class="gherkin-keyword">|</span> object <span class="gherkin-keyword">|</span>
      <span class="gherkin-keyword">Given </span>I save '${file:UTF-8:target/test-classes/testSOATtag.json}' in variable 'VAR'
      <span class="gherkin-keyword">Then </span>I run '[ "${VAR}" = "<content>" ]' locally

      <span class="gherkin-keyword">Examples:</span>
        <span class="gherkin-keyword">|</span> content  <span class="gherkin-keyword">|</span> file                                                <span class="gherkin-keyword">|</span>
        <span class="gherkin-keyword">|</span> {"a":{}} <span class="gherkin-keyword">|</span> ${file:UTF-8:src/test/resources/schemas/empty.json} <span class="gherkin-keyword">|</span>
			</code></pre>
			</div>
			</ul>
			<ul>
			<li><h3>With scenarios outlines and datatables2</h3></li>
			<div class="highlight">
			<pre><code class="language-gherkin">
			
    <span class="gherkin-keyword">Scenario Outline: </span>With scenarios outlines and datatables2
      <span class="gherkin-keyword">Given </span>I run 'ls' locally
      <span class="gherkin-keyword">Given </span>I create file 'testSOATtag.json' based on 'schemas/simple1.json' as 'json' with:
        <span class="gherkin-keyword">|</span> $.a     <span class="gherkin-keyword">|</span> REPLACE <span class="gherkin-keyword">|</span> ${file:UTF-8:src/test/resources/schemas/<file>.json} <span class="gherkin-keyword">|</span> object <span class="gherkin-keyword">|</span>
        <span class="gherkin-keyword">|</span> b       <span class="gherkin-keyword">|</span> ADD     <span class="gherkin-keyword">|</span> ${WAIT}                                              <span class="gherkin-keyword">|</span> N/A    <span class="gherkin-keyword">|</span>
        <span class="gherkin-keyword">|</span> ${WAIT} <span class="gherkin-keyword">|</span> ADD     <span class="gherkin-keyword">|</span> ${file:UTF-8:src/test/resources/schemas/<file>.json} <span class="gherkin-keyword">|</span> object <span class="gherkin-keyword">|</span>
      <span class="gherkin-keyword">Given </span>I save '${file:UTF-8:target/test-classes/testSOATtag.json}' in variable 'VAR'
      <span class="gherkin-keyword">Then </span>I run '[ "${VAR}" = "<content>" ]' locally

      <span class="gherkin-keyword">Examples:</span>
        <span class="gherkin-keyword">|</span> content                 <span class="gherkin-keyword">|</span> file    <span class="gherkin-keyword">|</span>
        <span class="gherkin-keyword">|</span> {"a":{},"1":{},"b":"1"} <span class="gherkin-keyword">|</span> empty   <span class="gherkin-keyword">|</span>
        <span class="gherkin-keyword">|</span> {"a":{},"1":{},"b":"1"} <span class="gherkin-keyword">|</span> simple0 <span class="gherkin-keyword">|</span>
			</code></pre>
			</div>
			</ul>
			<ul>
			<li><h3>Reading a file and saving it in a variable</h3></li>
			<div class="highlight">
			<pre><code class="language-gherkin">
			
    <span class="gherkin-keyword">Scenario: </span>Reading a file and saving it in a variable
      <span class="gherkin-keyword">Given </span>I save '${file:UTF-8:src/test/resources/schemas/empty.json}' in variable 'VAR'
      <span class="gherkin-keyword">Then </span>I run '[ "${VAR}" = "{}" ]' locally
      #log The same operation can be done with $variables
      <span class="gherkin-keyword">Given </span>I save '${file:UTF-8:src/test/resources/schemas/empty.json}' in variable 'VAR'
      <span class="gherkin-keyword">Then </span>I run '[ "${VAR}" = "{}" ]' locally
			</code></pre>
			</div>
			</ul>

			<hr>

		</ol>
	</div>

	<footer>
		<em>Automatically generated documentation for <a href="https://github.com/veepee-oss/gingerspec">GingerSpec library</a>.</em>
	</footer>

	<script>
		/*! tableOfContents.js v1.0.0 | (c) 2020 Chris Ferdinandi | MIT License | http://github.com/cferdinandi/table-of-contents */

/*
 * Automatically generate a table of contents from the headings on the page
 * @param  {String} content A selector for the element that the content is in
 * @param  {String} target  The selector for the container to render the table of contents into
 * @param  {Object} options An object of user options [optional]
 */
var tableOfContents = function (content, target, options) {

	//
	// Variables
	//

	// Get content
	var contentWrap = document.querySelector(content);
	var toc = document.querySelector(target);
	if (!contentWrap || !toc) return;

	// Settings & Defaults
	var defaults = {
		levels: 'h2, h3, h4, h5, h6',
		heading: 'Table of Contents',
		headingLevel: 'h2',
		listType: 'ul'
	};
	var settings = {};

	// Placeholder for headings
	var headings;


	//
	// Methods
	//

	/**
	 * Merge user options into defaults
	 * @param  {Object} obj The user options
	 */
	var merge = function (obj) {
		for (var key in defaults) {
			if (Object.prototype.hasOwnProperty.call(defaults, key)) {
				settings[key] = Object.prototype.hasOwnProperty.call(obj, key) ? obj[key] : defaults[key];
			}
		}
	};

	/**
	 * Create an ID for a heading if one does not exist
	 * @param  {Node} heading The heading element
	 */
	var createID = function (heading) {
		if (heading.id.length) return;
		heading.id = 'toc_' + heading.textContent.replace(/[^A-Za-z0-9]/g, '-');
	};

	/**
	 * Get the HTML to indent a list a specific number of levels
	 * @param  {Integer} count The number of times to indent the list
	 * @return {String}        The HTML
	 */
	var getIndent = function (count) {
		var html = '';
		for (var i = 0; i < count; i++) {
			html += '<' + settings.listType + '>';
		}
		return html;
	};

	/**
	 * Get the HTML to close an indented list a specific number of levels
	 * @param  {Integer} count The number of times to "outdent" the list
	 * @return {String}        The HTML
	 */
	var getOutdent = function (count) {
		var html = '';
		for (var i = 0; i < count; i++) {
			html += '</' + settings.listType + '></li>';
		}
		return html;
	};

	/**
	 * Get the HTML string to start a new list of headings
	 * @param  {Integer} diff  The number of levels in or out from the current level the list is
	 * @param  {Integer} index The index of the heading in the "headings" NodeList
	 * @return {String}        The HTML
	 */
	var getStartingHTML = function (diff, index) {

		// If indenting
		if (diff > 0) {
			return getIndent(diff);
		}

		// If outdenting
		if (diff < 0) {
			return getOutdent(Math.abs(diff));
		}

		// If it's not the first item and there's no difference
		if (index && !diff) {
			return '</li>';
		}

		return '';

	};

	/**
	 * Inject the table of contents into the DOM
	 */
	var injectTOC = function () {

		// Track the current heading level
		var level = headings[0].tagName.slice(1);
		var startingLevel = level;

		// Cache the number of headings
		var len = headings.length - 1;

		// Inject the HTML into the DOM
		toc.innerHTML =
			'<' + settings.headingLevel + '>' + settings.heading + '</' + settings.headingLevel + '>' +
			'<' + settings.listType + '>' +
				Array.prototype.map.call(headings, function (heading, index) {

					// Add an ID if one is missing
					createID(heading);

					// Check the heading level vs. the current list
					var currentLevel = heading.tagName.slice(1);
					var levelDifference = currentLevel - level;
					level = currentLevel;
					var html = getStartingHTML(levelDifference, index);

					// Generate the HTML
					html +=
						'<li>' +
							'<a href="#' + heading.id + '">' +
								heading.innerHTML.trim() +
							'</a>';

					// If the last item, close it all out
					if (index === len) {
						html += getOutdent(Math.abs(startingLevel - currentLevel));
					}

					return html;

				}).join('') +
			'</' + settings.listType + '>';
	};

	/**
	 * Initialize the script
	 */
	var init = function () {

		// Merge any user settings into the defaults
		merge(options || {});

		// Get the headings
		// If none are found, don't render a list
		headings = contentWrap.querySelectorAll(settings.levels);
		if (!headings.length) return;

		// Inject the table of contents
		injectTOC();

	};


	//
	// Initialize the script
	//

	init();

};
	</script>
	<script>
		//Get the button:
mybutton = document.getElementById("myBtn");

// When the user scrolls down 20px from the top of the document, show the button
window.onscroll = function() {scrollFunction()};

function scrollFunction() {
    if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
        mybutton.style.display = "block";
    } else {
        mybutton.style.display = "none";
    }
}

// When the user clicks on the button, scroll to the top of the document
function topFunction() {
    document.body.scrollTop = 0; // For Safari
    document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
}
	</script>
	<script>
		function createCopyButton(highlightDiv) {
    const button = document.createElement("button");
    button.className = "copy-code-button";
    button.type = "button";
    button.innerText = "Copy";
    button.addEventListener("click", () =>
        copyCodeToClipboard(button, highlightDiv)
    );
    addCopyButtonToDom(button, highlightDiv);
}

async function copyCodeToClipboard(button, highlightDiv) {
    const codeToCopy = highlightDiv.querySelector(":last-child > code")
        .innerText;
    try {
        result = await navigator.permissions.query({ name: "clipboard-write" });
        if (result.state == "granted" || result.state == "prompt") {
            await navigator.clipboard.writeText(codeToCopy);
        } else {
            copyCodeBlockExecCommand(codeToCopy, highlightDiv);
        }
    } catch (_) {
        copyCodeBlockExecCommand(codeToCopy, highlightDiv);
    } finally {
        codeWasCopied(button);
    }
}

function copyCodeBlockExecCommand(codeToCopy, highlightDiv) {
    const textArea = document.createElement("textArea");
    textArea.contentEditable = "true";
    textArea.readOnly = "false";
    textArea.className = "copyable-text-area";
    textArea.value = codeToCopy;
    highlightDiv.insertBefore(textArea, highlightDiv.firstChild);
    const range = document.createRange();
    range.selectNodeContents(textArea);
    const sel = window.getSelection();
    sel.removeAllRanges();
    sel.addRange(range);
    textArea.setSelectionRange(0, 999999);
    document.execCommand("copy");
    highlightDiv.removeChild(textArea);
}

function codeWasCopied(button) {
    button.blur();
    button.innerText = "Copied!";
    setTimeout(function () {
        button.innerText = "Copy";
    }, 2000);
}

function addCopyButtonToDom(button, highlightDiv) {
    highlightDiv.insertBefore(button, highlightDiv.firstChild);
    const wrapper = document.createElement("div");
    wrapper.className = "highlight-wrapper";
    highlightDiv.parentNode.insertBefore(wrapper, highlightDiv);
    wrapper.appendChild(highlightDiv);
}

document
    .querySelectorAll(".highlight")
    .forEach((highlightDiv) => createCopyButton(highlightDiv));

	</script>
	<script>
		tableOfContents('[data-content]', '[data-toc]', {
			heading: 'On this page...', // Change the headings
			listType: 'ol', // Change the list type
			// levels: 'h2, h3' // Change the levels used
		});
	</script>
</body>
</html>